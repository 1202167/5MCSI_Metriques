<!doctype html>
<title>5MCSI</title>
<h1>Bienvenue sur le projet Métriques</h1>
<h2>Ceci est le projet de : Prénom Nom</h2>
<p>Si cette page d'accueil est en ligne s'affiche alors vous avez déjà gagné 2 points sur votre note d'évaluation</p>
<p>Notions aquises : Vous avez lors de séquence de mise en ligne appris à utiliser GitHUB, créer des secrets et découvert l'industrialisation continue</p>
<p>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - </p>
<h3>Exercice 1 : Personaliser votre page d'accueil (1 point)</h3>
<p>Modifier le fichier hello.html de votre projet GitHUB afin de préciser votre Prénom et Nom dans la page d'accueil (ligne 4 du fichier hello.html)</p>
<p>Notion accquise lors de cet exercice : Vous avez pris connaissance de votre environnement GitHUB avec ses fichiers, ses répertoires et ses "Commits".</p>
<p>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - </p>
<h3>Exercice 2 : Création d'un route (2 points)</h3>
<p>Objectif : Création d'une nouvelle route (c'est à dire la création d'une API)</p>
L'exercice consiste à créer une nouvelle route /en/ qui affichera "Hello World !"
C'est à dire que l'internaute saisira l'adresse suivante dans son navigateur : <b>https://{Votre URL}/en/</b> et obtiendra le résultat "Hello World !". Vous allez pour cela, depuis GitHUB, ajouter le code suivant dans votre fichier <b>__init__.py</b> :
<pre><code><xmp>
@app.route("/en/")
def MonPremierAPI():
    return "<h2>Hello World !</h2>"
</xmp></code></pre>
Remarque importante : Ce code est à ajouter entre le bloc "app = Flask(__name__)" qui est le début du programme et le bloc "if __name__ == "__main__" à la fin du fichier qui est le lanceur de l'application Python.
<b>Attention l'indentation est très importante en Python.</b>
</p>
<p>Notion accquise lors de cet exercice : Vous avez appris à créer des API (des routes) dans une application Python. Vous pouvez créer autant d'API que vous le souhaitez.</p>
<p>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - </p>
<h3>Exercice 3 : Les données d'une API (3 points)</h3>
<p>Objectif : Utiliser des API externes pour en créer une nouvelle adaptée à vos besions.</p>
<p>Copier l'URL dans un nouvel onglet de votre navigateur et observez le résultat :</p>
https://api.openweathermap.org/data/2.5/forecast/daily?q=Paris,fr&cnt=16&appid=bd5e378503939ddaee76f12ad7a97608</p>
<p></p>Il s'agit ici des prévisions météorologique de Paris pour les 16 prochains jours.
Vous observerez que nous utilisons une API gratuite fourni par Openweathermap.
C'est typiquement le format que vous trouverez dans le cadre des métriques (serveurs, réseaux, etc..).</p>
<p></p>Les API fournissant en général des données au format JSON. JSON est format structuré avec des étiquettes, également appelé des keys, qui ont pour objectif de fournir des données "brut".<br/>
<b>Prenez quelques minutes pour "comprendre" la structure de ces données JSON.</b></p>
<p>- - - - - </p>
<p>Ce qui nous intérèsse ici, c'est d'extraire de valeur de [dt], c'est à dire les dates et les valeurs de [temp][day], c'est à dire les température du jour.</p>
<p>A noter que les dates sont au format "Timestamp", c'est à dire c'est le nombre de secondes depuis le 1 janvier 2000 (un légacy d'UNIX).
Les températures sont au format Kelvin (qu'il faudra convertir en °C).</p> 
<p>Vous allez à présent créer une nouvelle route "/paris/" dans votre application python pour filtrer l'API d'Openweathermap et extraire uniquement les dates et température du jour.
Ci-dessous la route à ajouter à votre application.
<pre><code><xmp>
@app.route('/paris/')
def meteo():
    response = urlopen('https://api.openweathermap.org/data/2.5/forecast/daily?q=Paris,fr&cnt=16&appid=bd5e378503939ddaee76f12ad7a97608')
    raw_content = response.read()
    json_content = json.loads(raw_content.decode('utf-8'))
    results = []
    for list_element in json_content.get('list', []):
        dt_value = list_element.get('dt')
        temp_day_value = list_element.get('temp', {}).get('day') - 273.15 # Conversion de Kelvin en °c 
        results.append({'Jour': dt_value, 'temp': temp_day_value})
    return jsonify(results=results)
</xmp></code></pre></p>
<p>- - - - - </p>
<b>Exercice 3 Bis : Les fichiers HTML</b>
<p>Ojectif : Commenprende la phylosophie des frameworks</p>
<p>Le framework Flask nous impose de déposer les fichiers HTML dans le répertoire templates.
Depuis GitHUB, nous allons donc créer et déposer dans le répertoire "templates" une page HTML qui sera accessible depuis la route suivante : https://{VOTRE_URL}/rapport/
</p>
<p>Etape 1.1 : Création d'un simple fichier graphique.html
Dans votre répertoire templates, créez un fichier graphique.html contenant le code suivant :
<pre><code><xmp>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Graphique</title>
 </head>  
<body>
    <h2>Mon Graphique</h2>
</body>
</html>
</xmp></code></pre></p>
<p>Etape 1.2 : Création d'une route
Créez à présent une route afin de pouvoir consulter votre fichier HTML.
Ajouter le code ci-dessous dans votre fichier __init__.py :
<pre><code><xmp>
@app.route("/rapport/")
def mongraphique():
    return render_template("graphique.html")
</xmp></code></pre></p>
</p
<p>Notions acquises de cet exerice : Nous avons vu dans cet exercice comment créer et où déposer les fichiers HTML dans le frameworks Flask.
Nous avons vu que les Framework (cadre de travail) nous impose donc une structure de travail.
</p>
<p>- - - - - </p>
<b>Exercice 3 Ter : Transfert de données</b>
<p>Mettons ces chiffres sous la forme d'un graphique qui sera pour l'utilisateur bien plus agréable à lire.
Pour cela, nous devons utiliser les données de notre API /rapport/ et les intégrer dans notre fichier HTML.
Nous allons utiliser utiliser une blibliothèque opensource de Google pour créer des graphique.</p>
<p>Modifier votre précédent fichier graphique.html et remplacer son code par celui-ci :
<pre><code><xmp>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Metrique</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  </head>  

  <body>
    <div id="chart_div"></div>
    <script>
      google.charts.load('current', { packages: ['corechart'] });
      google.charts.setOnLoadCallback(drawBackgroundColor);
     function drawBackgroundColor() {
    function drawChart(data) {
    // Convertir les données récupérées en un tableau utilisable par Google Charts
    var dataTable = new google.visualization.DataTable();
    dataTable.addColumn('string', 'Date');
    dataTable.addColumn('number', 'Valeur');
    data.results.forEach(entry => {
      var date = new Date(entry.Jour * 1000);
      dataTable.addRow([date.toLocaleDateString(), entry.temp]);
    });

    // Configurer les options du graphique en ligne
    var options = {
      title: 'Évolution des températures de Paris pour les 16 prochains jours',
      curveType: 'function',
      legend: { position: 'bottom' }
    };
    var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
    chart.draw(dataTable, options);
  }
  // Récupération de données depuis notre API /paris/
  fetch('/paris/')
    .then(response => response.json())
    .then(data => {
      drawChart(data);
    })
}
    </script>
  </body>
</html>
</xmp></code></pre></p>
<p>Notions acquises de cette séquence : Bravo ! Vous êtes à présent tous les outils qui vous permettrons de créer vos propres tableaux de bord.
Vous savez réccupérer des données issues d'une API externe , l'adapter à vos besions et créer vos propres graphiques.</p>
<p>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - </p>
<h3>Exercice 4 : Créér son histogramme  (2 points)</h3>
<p>Objectif : Savoir créer son graphique.</p>
<p>A l'aide des graphiques disponibles dans la galerie de Google à l'adresse suivante</p> 
<p>https://developers-dot-devsite-v2-prod.appspot.com/chart/interactive/docs/gallery?hl=fr
Créer un nouveau graphique à colonnes afin de présenter les températures de Paris pour les 16 prochains jours.
Ce nouveau graphique sera accessible sur votre site via le chemin suivant : https://{Votre URL}/histogramme/</p>
<p>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - </p>
<h3>Exercice 5 : Combien de Commits pour ce projet ?  (2 points)</h3>
<p>Objectif : Autonomie totale ...</p>
<p><b>Toutes les solutions informatiques proposent à présent des API</b>. GitHUB lui-même propose des API pour toutes sortes de mesures</p>
<p>Charge à vous de savoir les exertraires et les adapter à vos besions. Dans cet exercice, vous allez créer un graphique qui mesurera la quantité de commits que vous avez effectutés (minute par minute) pour réaliser de projet</p>
<p>Indice N°1 : Voici l'API utilisée pour extraire l'activité du repository qui est à l'origine de votre projet (celui que vous avez forker en début de séance)</p>
<p>https://api.github.com/repos/OpenRSI/5MCSI_Metriques/commits</p>
<p>Indice N°2 : Les données qui nous interrèsent ici sont : [Commit][author][date]</p>
<p>Indice N°3 : Voici une route qui saurait extraire les minutes d'une information formatée comme suit : "2024-02-11T11:57:27Z" </p>
<pre><code><xmp>
@app.route('/extract-minutes/<date_string>')
def extract_minutes(date_string):
        date_object = datetime.strptime(date_string, '%Y-%m-%dT%H:%M:%SZ')
        minutes = date_object.minute
        return jsonify({'minutes': minutes})
</xmp></code></pre></p>

